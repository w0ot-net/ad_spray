# AD Spray Sample Configuration
# Configured for a 5/30 lockout policy (5 attempts per 30 minute window)
# East Coast timezone with 9am-5pm business hours

[target]
# Domain controller IP or hostname
dc = 10.0.0.1

# NetBIOS domain name (e.g., CORP, CONTOSO)
workgroup = CORP

# Optional: Use LDAPS instead of LDAP
ssl = false

# Optional: Override default port (389 for LDAP, 636 for LDAPS)
# port = 389

[spray]
# File containing passwords to spray (one per line)
passwords_file = passwords.txt

# File containing usernames to spray (one per line)
# Use get-users command to enumerate from AD: ad_spray get-users -d DC -w DOMAIN -u USER -p PASS
users_file = users.txt

# Output file for valid credentials
output = valid_creds.txt

# Try username as password for each user
userpass = false

# Verbosity: 0=silent, 1=minimal, 2=normal, 3=verbose
verbose = 3

[timing]
# Lockout observation window in minutes
# Use get-policy command to fetch from AD: ad_spray get-policy -d DC -w DOMAIN -u USER -p PASS
lockout_window = 30

# Attempts per user per window (outside business hours)
# For a threshold of 5, use 4 attempts to stay safe (threshold - 1)
attempts = 4

# Attempts during business hours (set lower to be less noticeable)
# Set to 0 to pause spraying entirely during business hours
attempts_business = 2

[filter]
# Minimum password length (skip shorter passwords)
min_length = 8

# Require Windows complexity (3 of 4: upper, lower, digit, special)
complexity = true

[schedule]
# Timezone for business hours (IANA format)
# See: https://en.wikipedia.org/wiki/List_of_tz_database_time_zones
timezone = America/New_York

# Use system clock instead of external time verification (not recommended)
force_system_time = false

# Business hours per day (HH:MM-HH:MM, "off", or "pause")
#   off   = no restrictions, spray at full speed
#   pause = no spraying allowed this day
#   HH:MM-HH:MM = reduced attempts during these hours
monday = 09:00-17:00
tuesday = 09:00-17:00
wednesday = 09:00-17:00
thursday = 09:00-17:00
friday = 09:00-17:00
saturday = off
sunday = off
